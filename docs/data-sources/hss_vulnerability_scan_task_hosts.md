---
subcategory: "Host Security Service (HSS)"
layout: "huaweicloud"
page_title: "HuaweiCloud: huaweicloud_hss_vulnerability_scan_task_hosts"
description: |-
  Use this data source to get the list of hosts corresponding to vulnerability scan task.
---

# huaweicloud_hss_vulnerability_scan_task_hosts

Use this data source to get the list of hosts corresponding to vulnerability scan task.

-> Use this data source the `enterprise_project_id` need to set **all_granted_eps**. Otherwise, the operation may fail.

## Example Usage

```hcl
variable "task_id" {}

data "huaweicloud_hss_vulnerability_scan_task_hosts" "test" {
  task_id               = var.task_id
  enterprise_project_id = "all_granted_eps"
}
```

## Argument Reference

The following arguments are supported:

* `region` - (Optional, String) Specifies the region in which to query the resource.
  If omitted, the provider-level region will be used.

* `task_id` - (Required, String) Specifies the vulnerability scan task ID.

* `enterprise_project_id` - (Optional, String) Specifies the enterprise project ID.
  This parameter is valid only when the enterprise project is enabled.
  If you need to query data for all enterprise projects, the value is **all_granted_eps**.
  If you only have permissions for a specific enterprise project, you need set the enterprise project ID. Otherwise,
  the operation may fail due to insufficient permissions.

* `scan_status` - (Optional, String) Specifies the host scan status.
  The valid values are as follows:
  + **scanning**
  + **success**
  + **failed**

## Attribute Reference

In addition to all arguments above, the following attributes are exported:

* `id` - The data source ID.

* `data_list` - The list of hosts information.

  The [data_list](#data_list_struct) structure is documented below.

<a name="data_list_struct"></a>
The `data_list` block supports:

* `host_id` - The host ID.

* `host_name` - The host name.

* `public_ip` - The host EIP.

* `private_ip` - The host private IP address.

* `asset_value` - The asset importance.
  The valid values are as follows:
  + **important**
  + **common**
  + **test**

* `scan_status` - The host scan status.

* `failed_reasons` - The list of scan failure causes.

  The [failed_reasons](#failed_reasons_struct) structure is documented below.

* `vul_scan_details` - The host scan details.

  The [vul_scan_details](#vul_scan_details_struct) structure is documented below.

<a name="failed_reasons_struct"></a>
The `failed_reasons` block supports:

* `vul_type` - The vulnerability type.
  The valid values are as follows:
  + **linux_vul**
  + **windows_vul**
  + **web_cms**
  + **app_vul**
  + **urgent_vul**

* `failed_reason` - The cause of the scanning failure.

<a name="vul_scan_details_struct"></a>
The `vul_scan_details` block supports:

* `vul_type` - The vulnerability type.

* `status` - The vulnerability scan status.

* `failed_reason` - The reason of the scanning failure.
  The field is available only for vulnerabilities that fail to be scanned.

* `scan_vul_list` - The list of scan vulnerabilities.
  The field is available only when the `vul_type` is set to **app_vul**.

  The [scan_vul_list](#scan_vul_list_struct) structure is documented below.

<a name="scan_vul_list_struct"></a>
The `scan_vul_list` block supports:

* `vul_id` - The vulnerability ID.

* `vul_name` - The vulnerability name.

* `status` - The vulnerability scan status.

* `failed_reason` - The cause of the scanning failure.
  The field is available only for vulnerabilities that fail to be scanned.
